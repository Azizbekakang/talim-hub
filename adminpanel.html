<!DOCTYPE html>
<html lang="uz">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Panel | Ta'lim Hub</title>
<link rel="icon" type="image/png" href="logo.png">
<script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-900 text-white min-h-screen p-8">

<div class="container mx-auto">

  <h1 class="text-5xl font-bold text-center mb-10 text-red-300">ADMIN PANEL</h1>

  <!-- ======== OLIMPIADA QO‘SHISH ======== -->
  <h2 class="text-3xl font-bold mb-4">Olimpiada qo‘shish</h2>
  <input id="olimpName" placeholder="Olimpiada nomi" class="w-full p-3 rounded-xl bg-white/20 mb-3">
  <input id="olimpStart" placeholder="Boshlanish: DD.MM.YYYY HH:MM" class="w-full p-3 rounded-xl bg-white/20 mb-3">
  <input id="olimpEnd" placeholder="Tugash: DD.MM.YYYY HH:MM" class="w-full p-3 rounded-xl bg-white/20 mb-3">
  <button onclick="addOlimp()" class="bg-blue-600 w-full py-3 rounded-xl font-bold mb-10">QO‘SHISH</button>

  <!-- ======== MASALA QO‘SHISH ======== -->
  <h2 class="text-3xl font-bold mb-4">Masala qo‘shish</h2>
  <select id="olimpSelect" class="w-full p-3 rounded-xl bg-white/20 mb-3"></select>
  <input id="taskName" placeholder="Masala nomi (A, B, C ... avtomatik)" disabled class="w-full p-3 rounded-xl bg-white/20 mb-3 font-bold">
  <textarea id="taskText" placeholder="Masala matni" class="w-full p-3 rounded-xl bg-white/20 mb-3"></textarea>
  <textarea id="taskAns" placeholder="To‘g‘ri javobi" class="w-full p-3 rounded-xl bg-white/20 mb-3"></textarea>
  <button onclick="addTask()" class="bg-green-600 w-full py-3 rounded-xl font-bold">MASALA QO‘SHISH</button>

</div>

<script>
// ===== LocalStorage O‘qish =====
function getData(){ return JSON.parse(localStorage.getItem('olimpiadas') || '[]'); }
function saveData(data){ localStorage.setItem('olimpiadas', JSON.stringify(data)); }

// ===== Olimpiada qo‘shish =====
function addOlimp(){
  let data = getData();
  data.push({
    name: document.getElementById('olimpName').value,
    start: document.getElementById('olimpStart').value,
    end: document.getElementById('olimpEnd').value,
    tasks: [],
    users: []
  });
  saveData(data);
  alert("Olimpiada qo‘shildi!");
  loadSelect();
}

// ===== Masala qo‘shish =====
function addTask(){
  let data = getData();
  let idx = document.getElementById('olimpSelect').value;
  if(idx === "") return alert("Olimpiadani tanlang!");

  let letter = String.fromCharCode(65 + data[idx].tasks.length); // A, B, C...
  data[idx].tasks.push({
    name: letter,
    text: document.getElementById('taskText').value,
    ans: document.getElementById('taskAns').value
  });
  saveData(data);
  alert("Masala qo‘shildi!");
  loadSelect();
}

// ===== Selectni yuklash =====
function loadSelect(){
  let data = getData();
  let s = document.getElementById('olimpSelect');
  s.innerHTML = "";
  data.map((o,i)=> s.innerHTML += `<option value="${i}">${o.name}</option>`);
  let idx = s.value;
  if(idx!=="") document.getElementById('taskName').value = 
     String.fromCharCode(65 + data[idx].tasks.length);
}

loadSelect();
</script>

</body>
</html>
